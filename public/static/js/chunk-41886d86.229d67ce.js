(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41886d86"],{1117:function(t,e,a){},2423:function(t,e,a){"use strict";a.d(e,"c",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"f",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"e",(function(){return o}));var s=a("b775");function i(t){return Object(s["a"])({url:"/api/v1/admin/article",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/api/v1/user/article",method:"get",params:t})}function r(t){return Object(s["a"])({url:"/api/v1/admin/article",method:"post",data:t})}function l(t,e){return Object(s["a"])({url:"/api/v1/admin/article/"+t,method:"put",data:e})}function c(t){return Object(s["a"])({url:"/api/v1/admin/article/"+t,method:"get"})}function o(t){return Object(s["a"])({url:"/api/v1/user/article/"+t,method:"get"})}},"2e0a":function(t,e,a){"use strict";var s=a("5805"),i=a.n(s);i.a},5805:function(t,e,a){},7700:function(t,e,a){},"7f85":function(t,e,a){"use strict";var s=a("1117"),i=a.n(s);i.a},"92c5":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"card-mobile"},[a("div",{staticClass:"article-preview-header"},[a("h2",[t._v(t._s(t.article.title))])]),t._v(" "),a("div",{staticClass:"article-preview-body"},[a("span",{domProps:{innerHTML:t._s(t.article.text)}})]),t._v(" "),t.article.files.length>0?a("div",[a("div",{staticClass:"file-list-header"},[t._v("Файлы:")]),t._v(" "),a("ul",t._l(t.article.files,(function(e){return a("li",[t._v(t._s(e.name)+"\n          "),a("span",{staticClass:"file-size"},[t._v(t._s(t._f("sizeFilter")(e.size)))]),t._v(" "),a("el-link",{attrs:{href:t._f("urlFilter")(e.id),type:"success"}},[t._v("Скачать")])],1)})),0)]):t._e(),t._v(" "),a("div",{staticClass:"article-preview-footer"},[a("el-divider",{staticClass:"divider-footer"}),t._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between",align:"center"}},[a("el-col",{attrs:{span:14}},[a("span",{staticStyle:{"padding-left":"20px"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.back}},[t._v("Назад")])],1),t._v(" "),a("span",{staticStyle:{"padding-left":"20px"}},[1==t.article.allow_comments?a("el-button",{attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-chat-dot-square"}},[t._v(t._s(t.article.comments.length))]):t._e()],1)]),t._v(" "),a("el-col",{attrs:{span:10}},[a("div",{staticStyle:{"text-align":"right",padding:"10px 20px 0px 0",color:"#848484",height:"100%"}},[t._v(t._s(t._f("moment")(t.article.publish_time,"HH:mm DD-MM-YYYY")))])])],1)],1),t._v(" "),a("div",{staticClass:"comments-body"},[a("Comments",{model:{value:t.article,callback:function(e){t.article=e},expression:"article"}})],1)])],1)},i=[],n=(a("c5f6"),a("2423")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-comments"},[t._m(0),t._v(" "),t._l(t.value.comments,(function(e){return a("div",{staticClass:"comments-post"},[a("el-row",[a("el-col",{attrs:{xs:4,sm:2,lg:1,align:"middle"}},[a("el-avatar",{attrs:{size:"40",src:t._f("avatarUrl")(e.avatar)}})],1),t._v(" "),a("el-col",{attrs:{xs:20,sm:20,lg:20}},[a("div",{staticClass:"comment_author"},[t._v("\n          "+t._s(e.userName)+"\n        ")]),t._v(" "),a("div",{staticClass:"reply_text"},[a("div",[a("div",{staticClass:"wall_reply_text",domProps:{innerHTML:t._s(e.message)}})])]),t._v(" "),a("div",{staticClass:"comment_date"},[t._v("\n          "+t._s(t._f("moment")(e.created_at," DD MMM  в HH:mm"))+"\n        ")]),t._v(" "),a("el-divider",{staticClass:"divider"})],1)],1)],1)})),t._v(" "),t.user?a("el-row",{staticClass:"send",attrs:{align:"middle"}},[a("el-col",{attrs:{xs:4,sm:2,lg:1}},[a("el-avatar",{attrs:{size:"40",src:t._f("avatarUrl")(t.user.avatar)}})],1),t._v(" "),a("el-col",{attrs:{xs:16,sm:18,lg:19}},[a("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"Написать комментарий..."},model:{value:t.newComment,callback:function(e){t.newComment=e},expression:"newComment"}})],1),t._v(" "),a("el-col",{attrs:{xs:4,sm:2,lg:1}},[a("div",{staticClass:"comment-send",on:{click:t.sendComment}},[a("i",{staticClass:"el-icon-s-promotion"})])])],1):a("div",{staticClass:"no-send",attrs:{align:"middle"}},[a("router-link",{attrs:{to:"/login/index"}},[t._v("Чтобы оставить комментарий, необходимо авторизоваться")])],1)],2)},l=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment_title"},[a("strong",[t._v("Комментарий")])])}],c=(a("6762"),a("2fdb"),a("b775"));function o(t){return Object(c["a"])({url:"/api/v1/user/comment",method:"post",data:t})}var u={props:{value:{}},filters:{avatarUrl:function(t){return"/"===t[0]?"http://beta-lomo.posiyans.ru"+t:t}},data:function(){return{newComment:"",items:[]}},computed:{user:function(){return!this.$store.getters.user.allPermissions.includes("guest")&&this.$store.getters.user}},created:function(){},methods:{getComments:function(){},sendComment:function(){var t=this,e={article_id:this.value.id,message:this.newComment};o(e).then((function(e){e.data.status?t.value.comments.push(e.data.data):t.$message({message:"Не удалось добавить комментарий",type:"error"})})),this.newComment=""}}},d=u,m=(a("7f85"),a("2877")),v=Object(m["a"])(d,r,l,!1,null,"ac3acd7c",null),f=v.exports,p={components:{Comments:f},props:{id:{type:Number,default:0}},filters:{urlFilter:function(t){return"http://beta-lomo.posiyans.ru/user/storage/file/"+t},sizeFilter:function(t){if(t){var e=Math.floor(Math.log(t)/Math.log(1024));return 1*(t/Math.pow(1024,e)).toFixed(2)+" "+["B","kB","MB","GB","TB"][e]}return""}},mounted:function(){this.fetchArticle(),console.log(this.$route.params.id)},data:function(){return{article:{}}},methods:{back:function(){this.$router.back()},fetchArticle:function(){var t=this;console.log("fetch article"),console.log(this.id),Object(n["e"])(this.$route.params.id).then((function(e){console.log(e),t.article=e.data.data}))}}},_=p,h=(a("2e0a"),a("d464"),Object(m["a"])(_,s,i,!1,null,"205ff046",null));e["default"]=h.exports},d464:function(t,e,a){"use strict";var s=a("7700"),i=a.n(s);i.a}}]);